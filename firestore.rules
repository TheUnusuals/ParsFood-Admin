rules_version = '2';
service cloud.firestore {
  match /databases/{database}/documents {
    match /providers/{id} {
      allow read: if hasRole('admin') || hasRole('provider-admin') && request.auth.uid in resource.data.assignedAdmins;
  }

  match /databases/{database}/documents {
    match /providers/{providerId} {
      allow get, update;
    }
  }

  function hasRole(role) {
    return isSignedIn() && request.auth.token.role == role;
  }

  function hasAnyRole(roles) {
    return isSignedIn() && request.auth.token.role in roles;
  }

  function isSignedIn() {
    return request.auth != null;
  }
}
